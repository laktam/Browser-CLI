(()=>{"use strict";async function t(){let t=await chrome.tabs.query({}),e=[];console.log(t);let a=1;for(let o of t){let t="("+a+") "+o.title+" : "+o.url;o.highlighted&&(t+=" *"),e.push(t),a++}return e}function e(t){return t.split(" ")}async function a(t){let e=await chrome.tabs.query({});t=t.map((t=>Number.parseInt(t)-1));let a=[];for(let o of t)a.push(e[o].id);return console.log("tab ids in function ",a),a}chrome.runtime.onMessage.addListener((function(o,n,r){return"command"===o.action&&(console.log(o.command),async function(o){!function(t){let e=(t=t.replace("s{2,}"," ")).split(" ");const a={command:t=e[0]};if(e.length>1){let t=0;for(;t<e.length;)e[t].startsWith("-")&&t+1<e.length&&(a[e[t]]=e[t+1],t++),t++;const o=e.findLastIndex((t=>t.startsWith("-")))+2;o<e.length&&(a.arguments=e.slice(o))}console.log("command object",a)}(o);let n,r=keywords[0],i=keywords[1];"ls"==r?n=await t():"cd"==r?n=await async function(t){let e=await chrome.tabs.query({});chrome.tabs.update(e[Number.parseInt(t)-1].id,{active:!0})}(i):"rm"==r?n=await async function(t){let a=e(t);if("-g"==a[1]){let[t]=await chrome.tabGroups.query({title:a[2].slice(1,a[2].length-1)});console.log("group to ungroup ",t);let e=t.id,o=await chrome.tabs.query({}),n=[];for(let t of o)t.groupId==e&&n.push(t.id);await chrome.tabs.remove(n)}else{let e=await chrome.tabs.query({});chrome.tabs.remove(e[Number.parseInt(t)-1].id)}}(o):"find"==r?n=await async function(e){e=e.slice(1,e.length-1),console.log("arg ",e);let a=await t();return a=a.filter((t=>t.includes(e))),console.log("found tabs ",a),a}(i):"pwd"==r?n=await async function(){let[t]=await chrome.tabs.query({active:!0,currentWindow:!0});return t.title+" : "+t.url}():"create"==r?n=await async function(t){let a=e(t),o=!1,n="";"--active"==a[1]||"-a"==a[1]?(o=!0,n=a[2].slice(1,a[2].length-1)):n=a[1].slice(1,a[1].length-1),n.includes("http")||(n="https://"+n),chrome.tabs.create({active:o,url:n})}(o):"group"==r?n=await async function(t){let o,n=e(t);if(await chrome.tabs.query({}),"--new"==n[1]){let[t,e,r,...i]=n;r=n[2].slice(1,n[2].length-1);let s=await a(i);o=await chrome.tabs.group({tabIds:s}),await chrome.tabGroups.update(o,{collapsed:!1,title:r})}else if("--name"==n[1]){let[t,e,o,...r]=n;o=n[2].slice(1,n[2].length-1);let i=await a(r),s=await chrome.tabGroups.query({title:o});console.log("groups found ",s),await chrome.tabs.group({tabIds:i,groupId:s[0].id})}}(o):"ungroup"==r&&(n=await async function(t){let o=e(t);if("--tabs"==o[1]||"-t"==o[1]){let[t,e,...n]=o,r=await a(n);await chrome.tabs.ungroup(r)}else if("-g"==o[1]){let[t]=await chrome.tabGroups.query({title:o[2].slice(1,o[2].length-1)});console.log("group to ungroup ",t);let e=t.id,a=await chrome.tabs.query({}),n=[];for(let t of a)t.groupId==e&&n.push(t.id);await chrome.tabs.ungroup(n)}}(o)),chrome.runtime.sendMessage({action:r,data:n})}(o.command),r()),!0}))})();