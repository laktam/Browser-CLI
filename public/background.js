(()=>{"use strict";async function e(){let e=await chrome.tabs.query({}),t=[];console.log(e);let n=1;for(let a of e){let e="("+n+") "+a.title+" : "+a.url;a.highlighted&&(e+=" *"),t.push(e),n++}return t}async function t(){let[e]=await chrome.tabs.query({active:!0,currentWindow:!0});return console.log(e.id),e.id}function n(e,t){chrome.tabs.sendMessage(e,{action:t})}let a={};chrome.runtime.onMessage.addListener((function(n,a,o){return"command"===n.action&&(console.log(n.command),async function(n){const a=function(e){return e.split(" ")}(n);let o,i=a[0],c=a[1],r=await t();"ls"==i?o=await e():"cd"==i?o=await async function(e){let t=await chrome.tabs.query({});chrome.tabs.update(t[Number.parseInt(e)-1].id,{active:!0})}(c):"rm"==i?o=await async function(e){let t=await chrome.tabs.query({});chrome.tabs.remove(t[Number.parseInt(e)-1].id)}(c):"find"==i?o=await async function(t){t=t.slice(1,t.length-1),console.log("arg ",t);let n=await e();return n=n.filter((e=>e.includes(t))),console.log("found tabs ",n),n}(c):"pwd"==i&&(o=await async function(){let[e]=await chrome.tabs.query({active:!0,currentWindow:!0});return e.title+" : "+e.url}()),chrome.tabs.sendMessage(r,{action:i,data:o})}(n.command),o()),!0})),chrome.commands.onCommand.addListener((function(e){return"open-terminal"===e&&t().then((e=>{console.log("open terminal command,  tabsWithOpenTerminal[id]:",a[e]),null==a[e]||0==a[e]?(a[e]=!0,n(e,"open-terminal")):!0===a[e]&&(a[e]=!1,n(e,"close-terminal"))})),!0}))})();