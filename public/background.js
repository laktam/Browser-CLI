(()=>{"use strict";async function e(){let e=await chrome.tabs.query({}),t=[];console.log(e);let n=1;for(let a of e){let e="("+n+") "+a.title+" : "+a.url;a.highlighted&&(e+=" *"),t.push(e),n++}return t}function t(e){return e.split(" ")}async function n(){let[e]=await chrome.tabs.query({active:!0,currentWindow:!0});return console.log(e.id),e.id}function a(e,t){chrome.tabs.sendMessage(e,{action:t})}let o={};chrome.runtime.onMessage.addListener((function(a,o,c){return"command"===a.action&&(console.log(a.command),async function(a){const o=function(e){return e.split(" ")}(a);let c,i=o[0],r=o[1],s=await n();"ls"==i?c=await e():"cd"==i?c=await async function(e){let t=await chrome.tabs.query({});chrome.tabs.update(t[Number.parseInt(e)-1].id,{active:!0})}(r):"rm"==i?c=await async function(e){let t=await chrome.tabs.query({});chrome.tabs.remove(t[Number.parseInt(e)-1].id)}(r):"find"==i?c=await async function(t){t=t.slice(1,t.length-1),console.log("arg ",t);let n=await e();return n=n.filter((e=>e.includes(t))),console.log("found tabs ",n),n}(r):"pwd"==i?c=await async function(){let[e]=await chrome.tabs.query({active:!0,currentWindow:!0});return e.title+" : "+e.url}():"create"==i?c=await async function(e){let n=t(e),a=!1,o="";"--active"==n[1]||"-a"==n[1]?(a=!0,o=n[2].slice(1,n[2].length-1)):o=n[1].slice(1,n[1].length-1),chrome.tabs.create({active:a,url:o})}(a):"group"==i&&(c=await async function(e){let n=t(e),a=await chrome.tabs.query({}),o="";if("--new"==n[1]||"-n"==n[1]){o=n[2].slice(1,n[2].length-1);let[e,t,...c]=n;console.log("ids ",c),c=c.map((e=>Number.parseInt(e)-1));let i=[];for(let e of c)i.push(a[e].id);console.log("Tabids ",i),chrome.tabs.group({tabIds:i})}}(a)),chrome.tabs.sendMessage(s,{action:i,data:c})}(a.command),c()),!0})),chrome.commands.onCommand.addListener((function(e){return"open-terminal"===e&&n().then((e=>{console.log("open terminal command,  tabsWithOpenTerminal[id]:",o[e]),null==o[e]||0==o[e]?(o[e]=!0,a(e,"open-terminal")):!0===o[e]&&(o[e]=!1,a(e,"close-terminal"))})),!0}))})();