(()=>{"use strict";async function e(){let e=await chrome.tabs.query({}),t=[];console.log(e);let a=1;for(let n of e){let e="("+a+") "+n.title+" : "+n.url;n.highlighted&&(e+=" *"),t.push(e),a++}return t}function t(e){return e.split(" ")}async function a(){let[e]=await chrome.tabs.query({active:!0,currentWindow:!0});return console.log(e.id),e.id}function n(e,t){chrome.tabs.sendMessage(e,{action:t})}let o={};chrome.runtime.onMessage.addListener((function(n,o,i){return"command"===n.action&&(console.log(n.command),async function(n){const o=function(e){return e.split(" ")}(n);let i,r=o[0],c=o[1],s=await a();"ls"==r?i=await e():"cd"==r?i=await async function(e){let t=await chrome.tabs.query({});chrome.tabs.update(t[Number.parseInt(e)-1].id,{active:!0})}(c):"rm"==r?i=await async function(e){let t=await chrome.tabs.query({});chrome.tabs.remove(t[Number.parseInt(e)-1].id)}(c):"find"==r?i=await async function(t){t=t.slice(1,t.length-1),console.log("arg ",t);let a=await e();return a=a.filter((e=>e.includes(t))),console.log("found tabs ",a),a}(c):"pwd"==r?i=await async function(){let[e]=await chrome.tabs.query({active:!0,currentWindow:!0});return e.title+" : "+e.url}():"create"==r?i=await async function(e){let a=t(e),n=!1,o="";"--active"==a[1]||"-a"==a[1]?(n=!0,o=a[2].slice(1,a[2].length-1)):o=a[1].slice(1,a[1].length-1),chrome.tabs.create({active:n,url:o})}(n):"group"==r&&(i=await async function(e){let a,n=t(e),o=await chrome.tabs.query({});if("--new"==n[1]){let[e,t,i,...r]=n;i=n[2].slice(1,n[2].length-1),console.log("ids ",r),r=r.map((e=>Number.parseInt(e)-1));let c=[];for(let e of r)c.push(o[e].id);console.log("Tabids ",c),a=await chrome.tabs.group({tabIds:c}),await chrome.tabGroups.update(a,{collapsed:!1,title:i})}else if("--name"==n[1]){let[e,t,a,...i]=n;a=n[2].slice(1,n[2].length-1),i=i.map((e=>Number.parseInt(e)-1));let r=[];for(let e of i)r.push(o[e].id);let c=await chrome.tabGroups.query({title:a});console.log("groups found ",c),await chrome.tabs.group({tabIds:r,groupId:c[0].id})}}(n)),chrome.tabs.sendMessage(s,{action:r,data:i})}(n.command),i()),!0})),chrome.commands.onCommand.addListener((function(e){return"open-terminal"===e&&a().then((e=>{console.log("open terminal command,  tabsWithOpenTerminal[id]:",o[e]),null==o[e]||0==o[e]?(o[e]=!0,n(e,"open-terminal")):!0===o[e]&&(o[e]=!1,n(e,"close-terminal"))})),!0}))})();