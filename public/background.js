(()=>{"use strict";async function t(){let t=await chrome.tabs.query({}),e=[];console.log(t);let a=1;for(let n of t){let t="("+a+") "+n.title+" : "+n.url;n.highlighted&&(t+=" *"),e.push(t),a++}return e}function e(t){return t.split(" ")}async function a(){let[t]=await chrome.tabs.query({active:!0,currentWindow:!0});return console.log(t.id),t.id}function n(t,e){chrome.tabs.sendMessage(t,{action:e})}async function o(n){const o=function(t){return t.split(" ")}(n);let i,r=o[0],c=o[1],s=await a();"ls"==r?i=await t():"cd"==r?i=await async function(t){let e=await chrome.tabs.query({});chrome.tabs.update(e[Number.parseInt(t)-1].id,{active:!0})}(c):"rm"==r?i=await async function(t){let e=await chrome.tabs.query({});chrome.tabs.remove(e[Number.parseInt(t)-1].id)}(c):"find"==r?i=await async function(e){e=e.slice(1,e.length-1),console.log("arg ",e);let a=await t();return a=a.filter((t=>t.includes(e))),console.log("found tabs ",a),a}(c):"pwd"==r?i=await async function(){let[t]=await chrome.tabs.query({active:!0,currentWindow:!0});return t.title+" : "+t.url}():"create"==r?i=await async function(t){let a=e(t),n=!1,o="";"--active"==a[1]||"-a"==a[1]?(n=!0,o=a[2].slice(1,a[2].length-1)):o=a[1].slice(1,a[1].length-1),chrome.tabs.create({active:n,url:o})}(n):"group"==r?i=await async function(t){let a,n=e(t),o=await chrome.tabs.query({});if("--new"==n[1]){let[t,e,i,...r]=n;i=n[2].slice(1,n[2].length-1),console.log("ids ",r),r=r.map((t=>Number.parseInt(t)-1));let c=[];for(let t of r)c.push(o[t].id);console.log("Tabids ",c),a=await chrome.tabs.group({tabIds:c}),await chrome.tabGroups.update(a,{collapsed:!1,title:i})}else if("--name"==n[1]){let[t,e,a,...i]=n;a=n[2].slice(1,n[2].length-1),i=i.map((t=>Number.parseInt(t)-1));let r=[];for(let t of i)r.push(o[t].id);let c=await chrome.tabGroups.query({title:a});console.log("groups found ",c),await chrome.tabs.group({tabIds:r,groupId:c[0].id})}}(n):"ungroup"==r&&(i=await async function(t){let a=e(t);if("--tabs"==a[1]||"-t"==a[1]){let[t,e,...n]=a,o=await async function(t){let e=await chrome.tabs.query({});t=t.map((t=>Number.parseInt(t)-1));let a=[];for(let n of t)a.push(e[n].id);return console.log("tab ids in function ",a),a}(n);await chrome.tabs.ungroup(o)}}(n)),chrome.tabs.sendMessage(s,{action:r,data:i})}let i={};chrome.runtime.onMessage.addListener((function(t,e,a){return"command"===t.action&&(console.log(t.command),o(t.command),a()),!0})),chrome.commands.onCommand.addListener((function(t){return"open-terminal"===t&&a().then((t=>{console.log("open terminal command,  tabsWithOpenTerminal[id]:",i[t]),null==i[t]||0==i[t]?(i[t]=!0,n(t,"open-terminal")):!0===i[t]&&(i[t]=!1,n(t,"close-terminal"))})),!0}))})();